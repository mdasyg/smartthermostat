var $deviceProperties = null;
var $thisForm = null;
var $devicePropertyTemplate = null;

function addNewDeviceProperty() {
    var lastDevicePropertyDomId = parseInt($deviceProperties.find('.device-property').last().attr('data-index'));
    if (!lastDevicePropertyDomId) { lastDevicePropertyDomId = 0; }
    var nextDevicePropertyDomId = lastDevicePropertyDomId + 1;
    $devicePropertyTemplate.find('.device-property').attr('data-index', nextDevicePropertyDomId);
    $devicePropertyTemplate.find('.remove-device-property').attr('data-index', nextDevicePropertyDomId);
    $deviceProperties.append($devicePropertyTemplate.html());
}

function removeDeviceProperty() {
    $(this).closest('.device-property').remove();
}

function document_ready() {
    $devicePropertyTemplate = $('#device-property-template');
    $thisForm = $('#new_device');
    $deviceProperties = $thisForm.find('#device-properties-wrapper');

    $thisForm.on('click', '#add-new-device-property-button', addNewDeviceProperty);
    $thisForm.on('click', '.remove-device-property-button', removeDeviceProperty);
}

//$(document).ready( call-to-function ); // classic jQuery way but we use turbolinks
$(document).on("turbolinks:load", document_ready); // we need this because of turbolinks
